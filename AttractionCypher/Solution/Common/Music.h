#pragma once
#include <string>
#include <array>
#include <vector>

#define DEBUG_MUSIC 0


const int RHYTHM = 8;//一小節のテンポの数
const int BEAT   = 8;//一小節の譜面の数

class Music {
public:
	Music( ) { }
	virtual ~Music( ) { }
public:
	int getRhythmLength( double bpm ) const {
		return ( int )( 60 * 1000 / bpm );
	}
	int getMeasureLength( double bpm ) const {
		return getRhythmLength( bpm ) * RHYTHM;
	}
	
	int getBeatLength( double bpm ) const {
		return getMeasureLength( bpm ) / BEAT;
	}
};

// 奇数をインターバル曲
enum MUSIC {
#if !DEBUG_MUSIC
	MUSIC_0,
	MUSIC_1,
	MUSIC_2,
	MUSIC_3,
	MUSIC_4,
	MUSIC_5,
	MUSIC_6,
	MUSIC_7,
	MUSIC_8,
	MUSIC_9,
	MUSIC_10,
#else
	MUSIC_0,
#endif
	MAX_MUSIC
};

enum STATE {
	STATE_TUTORIAL,
	STATE_INTERVAL,
	STATE_BUTTEL,
	MAX_STATE
};


struct MusicInfo {
	std::string filename;
	int total_time;
	double bpm;
	int offset;
	MusicInfo( std::string filename, int total_time, double bpm, int offset ) {
		this->filename   = filename;
		this->total_time = total_time;
		this->bpm        = bpm;
		this->offset     = offset;
	};
};

#if !DEBUG_MUSIC
const MusicInfo INTERVAL_INFO = MusicInfo( "inter.mp3", 16000, 120.0, 0 );
#else
const MusicInfo INTERVAL_INFO = MusicInfo( "inter.mp3", 16000, 120.0, 0 );
#endif

static const std::array< MusicInfo, MAX_MUSIC >  MUSIC_INFO {
#if !DEBUG_MUSIC
	MusicInfo( "Time_leap_inst_free_ver1.mp3            ", 60000 * 1 + 42000, 140.0, 0 ),
	MusicInfo( "THE_NEW_CHALLENGER_free_Ver.mp3         ", 60000 * 2 + 06000,  91.3, 0 ),
	MusicInfo( "Re_cybernetic_Free_BGM_ver.mp3          ", 60000 * 2 + 03000, 174.0, 0 ),
	MusicInfo( "Quantization_Illusion_inst_Free_ver.mp3 ", 60000 * 1 + 37000, 135.0, 0 ),
	MusicInfo( "Mechanical_doll_Free_ver.mp3            ", 60000 * 2 + 19000, 144.6, 0 ),
	MusicInfo( "Goddess_of_the_victory_demo_ver.mp3     ", 60000 * 1 + 22000, 138.0, 0 ),
	MusicInfo( "Experimenta_Model_short.mp3             ", 60000 * 1 + 46000, 145.3, 0 ),
	MusicInfo( "cyber-dolls_free_bgm_v3.mp3             ", 60000 * 1 + 37000, 154.0, 0 ),
	MusicInfo( "Broadcast_free_ver.mp3                  ", 60000 * 1 + 30000, 127.0, 0 ),
	MusicInfo( "apparent_horizon_free_bgm_ver.mp3       ", 60000 * 2 + 14000, 146.5, 0 ),
	MusicInfo( "Ancient_Ocean_FreeVer.mp3               ", 60000 * 1 + 55000, 137.5, 0 ),
	//MusicInfo( "Isochronous_free_ver.mp3			    ", 60000 * 1 + 46000, 130, 0 ),
	//MusicInfo( "Synchronicity_free_ver.mp3			    ", 60000 * 1 + 00000, 130, 0 ),
#else
	MusicInfo( "debug.wav", 30000, 130, 0 ),
#endif
};


static const std::array< std::vector< std::array< char, BEAT > >, MAX_MUSIC >  MUSIC_SCORE {
#if !DEBUG_MUSIC
	std::vector< std::array< char, BEAT > > {//Time_leap
		{ 15, 10, 13,  2,  9, 14,  3,  1 },
		{  5,  6, 11,  8, 16,  7,  0, 14 },
		{ 15,  7,  1, 12, 13,  4, 17,  5 },
		{  9,  8, 16,  5, 15,  0, 11, 17 },
		{ 16, 10,  0,  5,  2,  6,  9,  1 },
		{  5,  4, 14,  3, 10, 12, 13,  1 },
		{  5, 16, 10,  6,  2,  0, 17, 12 },
		{  4, 14,  1,  3, 13, 15,  0,  5 },
		{  8, 14,  5, 13,  6, 16, 10,  1 },
		{  7,  1,  4, 13, 17, 16,  8, 14 },
		{ 11,  2, 17,  4, 12, 15,  9, 10 },
		{  8,  2, 15,  7, 13, 12, 11,  4 },
		{ 14, 15,  8,  3,  0,  6, 12,  4 },
		{ 16, 11,  2,  9,  3,  6,  0,  7 },
		{ 12,  8,  2,  6,  3, 10,  9,  5 },
		{  6, 11, 13,  9, 10, 17,  0,  5 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
		{  7, 17,  5,  6,  4,  0, 15,  8 },
		{ 13, 15, 11, 17, 16,  7,  8,  1 },
		{ 12,  5, 11,  8,  1, 17,  4, 14 },
		{ 14, 16,  0, 15, 11,  5,  8,  4 },
		{  0,  5, 12,  3,  1, 17, 14, 16 },
		{  2, 17, 15,  7, 13, 10, 11, 12 },
		{ 12, 17, 16,  5, 15,  6,  2,  3 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
		{  7, 17,  5,  6,  4,  0, 15,  8 },
		{ 13, 15, 11, 17, 16,  7,  8,  1 },
		{ 12,  5, 11,  8,  1, 17,  4, 14 },
		{ 14, 16,  0, 15, 11,  5,  8,  4 },
	},
	std::vector< std::array< char, BEAT > > {//THE_NEW
		{  6,  0, 12, 17,  4,  2, 11,  5 },
		{ 17, 11, 14,  6,  8,  2, 13, 15 },
		{ 15,  6,  3, 16,  2,  0, 11,  1 },
		{  4,  7, 12,  9,  2,  5,  6,  1 },
		{  7, 16, 11,  4,  8, 14, 15,  2 },
		{ 10, 12,  2, 13,  9, 11,  3, 14 },
		{  6,  0, 11,  5, 15, 14,  3, 16 },
		{ 10,  4, 13,  7, 15,  5, 12,  3 },
		{ 15,  2,  9,  4, 10, 13,  7, 11 },
		{  2, 11,  7,  0,  4, 17, 10,  1 },
		{  8, 14,  0,  1,  4, 15,  2,  7 },
		{ 12,  6, 13, 14,  2,  7, 17,  3 },
		{  2,  5, 13,  3,  4,  6, 17, 11 },
		{ 16,  2,  1,  7, 11,  6, 13,  9 },
		{  4, 12,  1, 14,  5, 15, 16, 13 },
		{  2, 14,  1, 16, 17,  0,  9, 12 },
		{ 14,  4, 17,  5,  9, 11, 10,  8 },
		{ 12, 17,  2,  3,  0, 14, 15,  5 },
		{ 17, 14, 13,  8,  0,  3, 15,  6 },
		{ 12,  5, 15,  4, 13,  6,  9,  8 },
		{  5,  4, 14,  1, 16,  6,  7, 10 },
		{  9,  5, 16, 13,  3,  4,  6,  1 },
		{  4,  9,  3,  2, 17, 16, 11,  8 },
		{ 12,  2, 11, 10,  5,  6,  0,  7 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
		{  7, 17,  5,  6,  4,  0, 15,  8 },
		{ 13, 15, 11, 17, 16,  7,  8,  1 },
		{ 12,  5, 11,  8,  1, 17,  4, 14 },
		{ 14, 16,  0, 15, 11,  5,  8,  4 },
		{ 12,  8,  2,  6,  3, 10,  9,  5 },
		{  6, 11, 13,  9, 10, 17,  0,  5 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
	},
	std::vector< std::array< char, BEAT > > {//Re_cybernetic
		{  0, 10, 11, 16,  4,  7, 12, 14 },
		{ 15, 14, 10,  2, 13, 12,  4,  0 },
		{ 10, 17, 13,  4,  3, 15,  0, 14 },
		{  8, 16,  4, 14, 12, 11,  3, 13 },
		{ 10, 16,  6, 12,  2,  4,  5, 14 },
		{ 13,  7,  0, 15,  6,  8,  1, 14 },
		{  7, 12,  0,  6, 13,  3,  8, 16 },
		{  4, 13,  1,  0, 10, 14, 17,  6 },
		{ 12,  1,  3, 17, 16,  5,  4, 10 },
		{ 10, 12,  6, 14, 11,  1, 15, 13 },
		{  4,  3,  0,  9,  2, 13, 16, 14 },
		{  8, 16, 13,  0,  6, 15,  2, 12 },
		{  7, 12, 14, 13,  4,  6,  8,  1 },
		{  4, 16, 11, 15,  9,  7,  6,  3 },
		{  7,  0,  3, 16,  9,  8, 11,  6 },
		{ 10,  3, 13, 16, 14,  0,  1,  2 },
		{  0, 15,  7, 10, 11,  6,  9,  5 },
		{  9, 10, 15,  2,  7, 12, 11,  8 },
		{ 11,  3,  8,  9,  4, 10, 12,  7 },
		{  3,  2,  4,  5, 11, 14,  1, 12 },
		{  0, 16,  6, 14,  3, 12,  9,  4 },
		{  6, 10,  0, 17,  1, 14,  3, 13 },
		{ 12,  6, 13,  7, 15,  1,  0, 11 },
		{ 15,  6, 11, 12,  9, 17,  1,  2 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{ 12, 17, 16,  5, 15,  6,  2,  3 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{ 12,  8,  2,  6,  3, 10,  9,  5 },
		{  6, 11, 13,  9, 10, 17,  0,  5 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
	},
	std::vector< std::array< char, BEAT > > {//Quantization_Illusion_inst_Free_ver
		{  7,  5,  3, 11, 10, 13,  1, 14 },
		{ 11, 10,  3,  8,  6, 12,  0,  5 },
		{  8,  5, 10, 15, 14,  7, 11, 16 },
		{  7, 14, 11,  3, 13, 16, 10,  4 },
		{  0, 17,  3,  2,  9,  7, 14,  6 },
		{ 16,  6,  3,  5, 17,  1,  2, 12 },
		{ 13, 14,  2,  3,  0, 17,  1, 15 },
		{ 17,  7,  1,  9, 15, 13,  6, 12 },
		{ 15,  9,  4, 14, 13,  6,  7, 11 },
		{ 12, 15,  6,  5, 13,  3, 14, 17 },
		{  8, 17, 15,  3,  9,  2, 16,  4 },
		{  3, 13,  0, 12,  2,  8,  1, 14 },
		{  1, 12, 17, 15,  9, 11,  3, 10 },
		{ 17, 16,  8,  7,  4, 12, 15,  0 },
		{  5, 13,  2,  4, 16, 17,  6, 11 },
		{ 15,  7, 12,  2,  4, 11, 13,  6 },
		{  4,  2,  8, 10,  0,  3, 16,  5 },
		{ 11,  8,  7,  6, 13,  3, 16,  1 },
		{  1, 12,  4, 14,  9,  6,  3,  2 },
		{ 12,  6, 11,  0,  1,  7,  3,  4 },
		{  0, 15, 16,  1,  7,  8, 10, 13 },
		{ 15,  9, 17, 13,  5,  8,  1, 11 },
		{  7, 11, 12,  4,  1, 13,  3,  9 },
		{ 15, 17, 13,  5,  8, 12,  1,  3 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{ 12, 17, 16,  5, 15,  6,  2,  3 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{ 12,  8,  2,  6,  3, 10,  9,  5 },
		{  6, 11, 13,  9, 10, 17,  0,  5 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
	},
	std::vector< std::array< char, BEAT > > {//Mechanical_doll_Free_ver
		{  9, 13,  0, 11,  8,  1, 16,  6 },
		{ 16, 15,  0, 11, 10,  6,  1, 17 },
		{  3,  6, 17, 16,  0,  7, 10, 13 },
		{  3,  7, 16, 11,  6, 12,  5, 13 },
		{ 17, 14,  9,  2,  1, 16, 13,  6 },
		{ 11, 16, 13, 15,  8,  6, 17, 12 },
		{  6,  3, 16, 17, 13, 12,  9,  0 },
		{ 11, 12, 17,  6, 15, 10, 16,  5 },
		{  2,  6,  1,  0, 10, 16,  5, 13 },
		{  4,  5, 15, 10, 16, 17, 13,  6 },
		{ 16, 13, 12, 17,  4, 10,  9, 11 },
		{ 13, 14,  4,  0, 11,  6,  2,  9 },
		{ 13,  1,  9, 12, 11, 15, 14,  8 },
		{  8, 10, 15, 13,  9,  3,  0,  5 },
		{  2, 16,  3,  5, 14, 10, 12, 15 },
		{ 15,  7,  5, 17,  0,  3, 12, 13 },
		{  3,  9, 11,  6, 13,  1, 15, 14 },
		{  9, 17,  1, 14,  3, 15,  4, 13 },
		{ 10,  1, 14, 17, 16, 15,  8,  5 },
		{  2, 13, 10, 17,  1,  5,  0,  7 },
		{  9, 16,  8,  0, 14,  1,  5, 10 },
		{ 16,  6,  5, 11,  1,  2,  4, 13 },
		{ 10,  8,  3, 11, 12,  0,  5, 14 },
		{  6,  0,  8,  1, 12, 10, 16,  5 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
		{  7, 17,  5,  6,  4,  0, 15,  8 },
		{ 13, 15, 11, 17, 16,  7,  8,  1 },
		{ 12,  5, 11,  8,  1, 17,  4, 14 },
		{ 14, 16,  0, 15, 11,  5,  8,  4 },
		{ 12,  8,  2,  6,  3, 10,  9,  5 },
		{  6, 11, 13,  9, 10, 17,  0,  5 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
	},
	std::vector< std::array< char, BEAT > > {//Goddess_of_the_victory_demo_ver
		{ 15, 10, 13,  2,  9, 14,  3,  1 },
		{  5,  6, 11,  8, 16,  7,  0, 14 },
		{ 15,  7,  1, 12, 13,  4, 17,  5 },
		{  9,  8, 16,  5, 15,  0, 11, 17 },
		{ 16, 10,  0,  5,  2,  6,  9,  1 },
		{  5,  4, 14,  3, 10, 12, 13,  1 },
		{  5, 16, 10,  6,  2,  0, 17, 12 },
		{  4, 14,  1,  3, 13, 15,  0,  5 },
		{  8, 14,  5, 13,  6, 16, 10,  1 },
		{  7,  1,  4, 13, 17, 16,  8, 14 },
		{ 11,  2, 17,  4, 12, 15,  9, 10 },
		{  8,  2, 15,  7, 13, 12, 11,  4 },
		{ 14, 15,  8,  3,  0,  6, 12,  4 },
		{ 16, 11,  2,  9,  3,  6,  0,  7 },
		{ 12,  8,  2,  6,  3, 10,  9,  5 },
		{  6, 11, 13,  9, 10, 17,  0,  5 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
		{  7, 17,  5,  6,  4,  0, 15,  8 },
		{ 13, 15, 11, 17, 16,  7,  8,  1 },
		{ 12,  5, 11,  8,  1, 17,  4, 14 },
		{ 14, 16,  0, 15, 11,  5,  8,  4 },
		{  0,  5, 12,  3,  1, 17, 14, 16 },
		{  2, 17, 15,  7, 13, 10, 11, 12 },
		{ 12, 17, 16,  5, 15,  6,  2,  3 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
		{  7, 17,  5,  6,  4,  0, 15,  8 },
		{ 13, 15, 11, 17, 16,  7,  8,  1 },
		{ 12,  5, 11,  8,  1, 17,  4, 14 },
		{ 14, 16,  0, 15, 11,  5,  8,  4 },
		{ 12,  8,  2,  6,  3, 10,  9,  5 },
		{  6, 11, 13,  9, 10, 17,  0,  5 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
	},
	std::vector< std::array< char, BEAT > > {//Experimenta_Model_short
		{ 14,  4,  0,  1, 10,  2, 13,  6 },
		{  2,  0, 13,  6,  4, 10,  9, 16 },
		{ 11, 16,  5,  0, 13, 10,  1,  2 },
		{  8, 16,  7, 13,  3, 11, 10, 17 },
		{ 10,  6,  1, 17,  5, 14,  8,  9 },
		{ 13,  3,  0, 10, 15,  6,  1, 12 },
		{ 11, 17,  0, 14,  1,  4,  3, 16 },
		{ 17, 12, 10, 11,  3, 14, 13,  6 },
		{ 13,  0,  2, 10,  7,  4, 16,  3 },
		{ 13,  8,  9,  0,  5,  2, 16, 11 },
		{ 12, 10,  3,  7,  4,  5, 14, 17 },
		{ 10, 11, 17,  2,  5,  3, 15,  7 },
		{ 16, 12, 14,  1,  2,  6, 17, 11 },
		{  6, 12, 16, 10,  9, 11,  5, 13 },
		{  9, 10,  5,  3, 16, 15, 12,  6 },
		{  5,  0, 15, 12,  8,  6, 17, 10 },
		{ 16, 17,  3,  1, 12,  8,  5, 10 },
		{  1, 17, 11, 14,  2, 13, 12,  4 },
		{  3, 16, 13, 17,  6,  5,  2,  0 },
		{  1,  2, 12, 16, 14,  9,  7, 17 },
		{  4, 11,  7,  2, 13,  8, 17,  1 },
		{ 12, 17,  2,  7,  9,  4,  5, 14 },
		{  3, 16,  5, 12,  7, 11, 15,  1 },
		{  9, 13,  0, 11,  8,  1, 16,  6 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
		{  7, 17,  5,  6,  4,  0, 15,  8 },
		{ 13, 15, 11, 17, 16,  7,  8,  1 },
		{ 12,  5, 11,  8,  1, 17,  4, 14 },
		{ 14, 16,  0, 15, 11,  5,  8,  4 },
		{ 12,  8,  2,  6,  3, 10,  9,  5 },
		{  6, 11, 13,  9, 10, 17,  0,  5 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
	},
	std::vector< std::array< char, BEAT > > {//cyber
		{ 11, 13,  7,  4, 15, 14,  9, 12 },
		{ 14, 13, 12, 16,  6, 10, 17,  2 },
		{ 17, 11, 13, 16,  1,  0,  3,  8 },
		{ 13, 10,  9,  8, 11,  2,  5, 14 },
		{  7,  3, 17,  2, 12, 15, 10, 16 },
		{  9, 11, 17,  6,  4, 13, 10,  7 },
		{  5, 16,  9,  7, 13, 17,  6,  4 },
		{ 12, 17,  8,  0,  9,  5,  2, 16 },
		{  5,  0, 13, 16,  7,  3, 15, 17 },
		{ 17,  8, 15, 14, 12,  0,  4, 16 },
		{ 15,  2, 13, 10,  3,  5,  9,  8 },
		{ 14,  9,  8,  1,  4, 17, 12,  6 },
		{ 10,  4, 17,  2,  3, 13,  9,  0 },
		{  8,  4,  5,  1, 14,  7, 13,  6 },
		{ 13, 17, 10,  2, 12,  0,  5,  8 },
		{ 16,  7,  3,  9,  0, 13,  8, 12 },
		{  5, 11,  0,  7,  9,  2,  4, 13 },
		{  9, 13, 15, 12,  1, 10,  3, 11 },
		{  7,  1, 10,  6, 12,  2,  0,  5 },
		{  5, 13, 12, 14,  3,  9, 16, 17 },
		{  4,  8, 11,  1,  5, 15, 17,  2 },
		{  2,  5,  9,  0, 12,  3,  1, 15 },
		{  0,  3, 15,  8,  2, 13,  1,  5 },
		{ 10,  0,  5, 15, 14, 13, 12,  9 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{ 12,  8,  2,  6,  3, 10,  9,  5 },
		{  6, 11, 13,  9, 10, 17,  0,  5 },
		{ 16,  7,  3,  9,  0, 13,  8, 12 },
		{  5, 11,  0,  7,  9,  2,  4, 13 },
		{  9, 13, 15, 12,  1, 10,  3, 11 },
		{  7,  1, 10,  6, 12,  2,  0,  5 },
		{  5, 13, 12, 14,  3,  9, 16, 17 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
		{ 12,  8,  2,  6,  3, 10,  9,  5 },
		{  6, 11, 13,  9, 10, 17,  0,  5 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
	},
	std::vector< std::array< char, BEAT > > {//Broadcast_free_ver
		{  9, 13,  0, 11,  8,  1, 16,  6 },
		{ 16, 15,  0, 11, 10,  6,  1, 17 },
		{  3,  6, 17, 16,  0,  7, 10, 13 },
		{  3,  7, 16, 11,  6, 12,  5, 13 },
		{ 17, 14,  9,  2,  1, 16, 13,  6 },
		{ 11, 16, 13, 15,  8,  6, 17, 12 },
		{  6,  3, 16, 17, 13, 12,  9,  0 },
		{ 11, 12, 17,  6, 15, 10, 16,  5 },
		{  2,  6,  1,  0, 10, 16,  5, 13 },
		{  4,  5, 15, 10, 16, 17, 13,  6 },
		{ 16, 13, 12, 17,  4, 10,  9, 11 },
		{ 13, 14,  4,  0, 11,  6,  2,  9 },
		{ 13,  1,  9, 12, 11, 15, 14,  8 },
		{  8, 10, 15, 13,  9,  3,  0,  5 },
		{  2, 16,  3,  5, 14, 10, 12, 15 },
		{ 15,  7,  5, 17,  0,  3, 12, 13 },
		{  3,  9, 11,  6, 13,  1, 15, 14 },
		{  9, 17,  1, 14,  3, 15,  4, 13 },
		{ 10,  1, 14, 17, 16, 15,  8,  5 },
		{  2, 13, 10, 17,  1,  5,  0,  7 },
		{  9, 16,  8,  0, 14,  1,  5, 10 },
		{ 16,  6,  5, 11,  1,  2,  4, 13 },
		{ 10,  8,  3, 11, 12,  0,  5, 14 },
		{  6,  0,  8,  1, 12, 10, 16,  5 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{  7,  1, 10,  6, 12,  2,  0,  5 },
		{  5, 13, 12, 14,  3,  9, 16, 17 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
		{ 12,  8,  2,  6,  3, 10,  9,  5 },
		{  6, 11, 13,  9, 10, 17,  0,  5 },
		{ 15,  7,  5, 17,  0,  3, 12, 13 },
		{  3,  9, 11,  6, 13,  1, 15, 14 },
		{  9, 17,  1, 14,  3, 15,  4, 13 },
		{ 10,  1, 14, 17, 16, 15,  8,  5 },
		{  2, 13, 10, 17,  1,  5,  0,  7 },
	},
	std::vector< std::array< char, BEAT > > {//apparent
		{  0, 10, 11, 16,  4,  7, 12, 14 },
		{ 15, 14, 10,  2, 13, 12,  4,  0 },
		{ 10, 17, 13,  4,  3, 15,  0, 14 },
		{  8, 16,  4, 14, 12, 11,  3, 13 },
		{ 10, 16,  6, 12,  2,  4,  5, 14 },
		{ 13,  7,  0, 15,  6,  8,  1, 14 },
		{  7, 12,  0,  6, 13,  3,  8, 16 },
		{  4, 13,  1,  0, 10, 14, 17,  6 },
		{ 12,  1,  3, 17, 16,  5,  4, 10 },
		{ 10, 12,  6, 14, 11,  1, 15, 13 },
		{  4,  3,  0,  9,  2, 13, 16, 14 },
		{  8, 16, 13,  0,  6, 15,  2, 12 },
		{  7, 12, 14, 13,  4,  6,  8,  1 },
		{  4, 16, 11, 15,  9,  7,  6,  3 },
		{  7,  0,  3, 16,  9,  8, 11,  6 },
		{ 10,  3, 13, 16, 14,  0,  1,  2 },
		{  0, 15,  7, 10, 11,  6,  9,  5 },
		{  9, 10, 15,  2,  7, 12, 11,  8 },
		{ 11,  3,  8,  9,  4, 10, 12,  7 },
		{  3,  2,  4,  5, 11, 14,  1, 12 },
		{  0, 16,  6, 14,  3, 12,  9,  4 },
		{  6, 10,  0, 17,  1, 14,  3, 13 },
		{ 12,  6, 13,  7, 15,  1,  0, 11 },
		{ 15,  6, 11, 12,  9, 17,  1,  2 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{ 12, 17, 16,  5, 15,  6,  2,  3 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{ 15,  7,  5, 17,  0,  3, 12, 13 },
		{  3,  9, 11,  6, 13,  1, 15, 14 },
		{  9, 17,  1, 14,  3, 15,  4, 13 },
		{ 10,  1, 14, 17, 16, 15,  8,  5 },
		{  2, 13, 10, 17,  1,  5,  0,  7 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
	},
	std::vector< std::array< char, BEAT > > {//Ancient
		{ 15, 10, 13,  2,  9, 14,  3,  1 },
		{  5,  6, 11,  8, 16,  7,  0, 14 },
		{ 15,  7,  1, 12, 13,  4, 17,  5 },
		{  9,  8, 16,  5, 15,  0, 11, 17 },
		{ 16, 10,  0,  5,  2,  6,  9,  1 },
		{  5,  4, 14,  3, 10, 12, 13,  1 },
		{  5, 16, 10,  6,  2,  0, 17, 12 },
		{  4, 14,  1,  3, 13, 15,  0,  5 },
		{  8, 14,  5, 13,  6, 16, 10,  1 },
		{  7,  1,  4, 13, 17, 16,  8, 14 },
		{ 11,  2, 17,  4, 12, 15,  9, 10 },
		{  8,  2, 15,  7, 13, 12, 11,  4 },
		{ 14, 15,  8,  3,  0,  6, 12,  4 },
		{ 16, 11,  2,  9,  3,  6,  0,  7 },
		{ 12,  8,  2,  6,  3, 10,  9,  5 },
		{  6, 11, 13,  9, 10, 17,  0,  5 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
		{  7, 17,  5,  6,  4,  0, 15,  8 },
		{ 13, 15, 11, 17, 16,  7,  8,  1 },
		{ 12,  5, 11,  8,  1, 17,  4, 14 },
		{ 14, 16,  0, 15, 11,  5,  8,  4 },
		{  0,  5, 12,  3,  1, 17, 14, 16 },
		{  2, 17, 15,  7, 13, 10, 11, 12 },
		{ 12, 17, 16,  5, 15,  6,  2,  3 },
		{  1, 16, 10, 17,  7,  8,  4,  3 },
		{ 13, 11, 10,  1,  6, 13,  3,  7 },
		{  2, 12, 10, 13, 15,  5, 11, 14 },
		{  0, 10,  9,  1,  6, 14, 17,  7 },
		{ 16, 15,  5,  4, 14,  7, 13,  9 },
		{  7, 17,  5,  6,  4,  0, 15,  8 },
		{ 13, 15, 11, 17, 16,  7,  8,  1 },
		{ 12,  5, 11,  8,  1, 17,  4, 14 },
		{ 14, 16,  0, 15, 11,  5,  8,  4 },
	},
#else
	std::vector< std::array< char, BEAT > > {//Music0
		{  2, 17,  1, 14,  9,  3,  3,  7 },
		{  2, 12,  7, 11, 10,  5,  4,  3 },
		{  9,  8, 12,  8, 11,  7,  3, 11 },
		{  2,  7,  8,  6,  5, 10, 11, 17 },
		{  1,  4,  8, 12, 11, 14, 16, 15 },
		{ 13,  0, 13, 16,  0, 11,  0, 10 }
	}
#endif
};

static std::array< char, BEAT > SKIP_MEASURE = { -1, -1, -1, -1, -1, -1, -1, -1 };